-- pro shit 

local playersService = game:GetService("Players")
local workspace = game:GetService("Workspace")
local lplr = playersService.LocalPlayer
local character = lplr.Character or lplr.CharacterAdded:Wait()
local rootPart = character:WaitForChild("HumanoidRootPart")

local remote = workspace:WaitForChild("Remote", 10)
local itemHandler = remote and remote:WaitForChild("ItemHandler", 10)

if not itemHandler or not itemHandler:IsA("RemoteFunction") then 
    return
end

local prisonItems = workspace:FindFirstChild("prison_ITEMS")
local pickupArgument = prisonItems and prisonItems:FindFirstChild("Key card", true) and prisonItems:FindFirstChild("Key card", true):FindFirstChild("ITEMPICKUP")

if not pickupArgument then
    return 
end

task.spawn(function()
    local keycardModel = nil
    local waitStartTime = tick()

    while not keycardModel and (tick() - waitStartTime < 60) do
        keycardModel = workspace:FindFirstChild("Key card")
        task.wait(0.5) 
    end
    
    if not keycardModel then
        return
    end
    
    local centerCFrame, size
    
    pcall(function()
        centerCFrame, size = keycardModel:GetBoundingBox()
    end)
    
    if centerCFrame then
        local onTopCFrame = centerCFrame * CFrame.new(0, size.Y / 2 + 3, 0)
        rootPart.CFrame = onTopCFrame 
        task.wait(0.1) 
    else

        rootPart.CFrame = keycardModel.PrimaryPart.CFrame * CFrame.new(0, 3, 0)
        task.wait(0.1)
    end
    
    
    local loopStartTime = tick()
    
    while workspace:FindFirstChild("Key card") and (tick() - loopStartTime < 10) do
        
        pcall(function()
            itemHandler:InvokeServer(pickupArgument)
        end)
        
        task.wait(0.1)
    end
    
end)
